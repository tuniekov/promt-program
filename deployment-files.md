# Файлы для развертывания приложения

В рамках задачи по развертыванию приложения на сервере Ubuntu 22.04 были созданы следующие файлы:

## 1. setup-ubuntu.sh

**Назначение**: Скрипт для настройки Ubuntu 22.04 с установкой необходимых пакетов и настроек безопасности.

**Что делает**:
- Обновляет систему
- Устанавливает необходимые пакеты (curl, wget, git, unzip, zip, htop, vim, ufw, fail2ban)
- Устанавливает Node.js и npm
- Устанавливает PM2 для управления процессами Node.js
- Устанавливает и настраивает Nginx как обратный прокси
- Настраивает брандмауэр (UFW)
- Настраивает fail2ban для защиты от брутфорс-атак
- Создает пользователя для приложения
- Настраивает безопасность SSH
- Настраивает автоматические обновления безопасности
- Настраивает временную зону

**Как использовать**:
```bash
chmod +x setup-ubuntu.sh
sudo ./setup-ubuntu.sh
```

## 2. deploy-app.bat

**Назначение**: Скрипт для развертывания приложения на сервер с использованием SSH команд Windows.

**Что делает**:
- Устанавливает кодовую страницу UTF-8 для корректного отображения русских символов
- Запрашивает данные для подключения к серверу (IP, логин, пароль)
- Создает временную директорию для подготовки файлов
- Копирует файлы проекта во временную директорию
- Создает .env файл с необходимыми переменными окружения
- Архивирует проект
- Копирует архив на сервер
- Создает и выполняет скрипт для распаковки архива, установки зависимостей и настройки приложения на сервере
- Очищает временные файлы

**Как использовать**:
```
deploy-app.bat
```

## 3. run-deployment.bat

**Назначение**: Мастер-скрипт для запуска полного процесса развертывания приложения (объединяет выполнение setup-ubuntu.sh и deploy-app.bat).

**Что делает**:
- Устанавливает кодовую страницу UTF-8 для корректного отображения русских символов
- Запрашивает данные для подключения к серверу (IP, логин, пароль)
- Копирует и выполняет скрипт setup-ubuntu.sh на сервере
- Запрашивает API ключ для OpenRouter и настройки платных моделей
- Создает временную директорию для подготовки файлов
- Копирует файлы проекта во временную директорию
- Создает .env файл с необходимыми переменными окружения
- Архивирует проект
- Копирует архив на сервер
- Создает и выполняет скрипт для распаковки архива, установки зависимостей и настройки приложения на сервере
- Очищает временные файлы

**Как использовать**:
```
run-deployment.bat
```

## 4. deployment-instructions.md

**Назначение**: Подробные инструкции по развертыванию приложения на сервере Ubuntu 22.04.

**Содержание**:
- Подготовка к развертыванию
- Шаг 1: Настройка сервера Ubuntu
- Шаг 2: Развертывание приложения
- Проверка работоспособности
- Устранение неполадок
- Обновление приложения
- Безопасность
- Примечания

**Как использовать**: Открыть файл в любом текстовом редакторе или просмотрщике Markdown.

## Требования для запуска скриптов

Для успешного запуска скриптов развертывания на Windows необходимо:

1. Утилита `plink.exe` из пакета PuTTY (должна находиться в той же директории, что и скрипты)
2. Утилита `psftp.exe` из пакета PuTTY (должна находиться в той же директории, что и скрипты)
3. Утилита `tar` для архивирования файлов (обычно уже установлена в Windows 10/11)

## Рекомендации по использованию

Для полного развертывания приложения с нуля рекомендуется использовать скрипт `run-deployment.bat`, который проведет вас через весь процесс развертывания.

Если вы хотите выполнить только часть процесса или у вас уже настроен сервер, вы можете использовать отдельные скрипты:
- `setup-ubuntu.sh` - только для настройки сервера
- `deploy-app.bat` - только для развертывания приложения на уже настроенный сервер

Для получения подробной информации о процессе развертывания обратитесь к файлу `deployment-instructions.md`.
